!function(t){"use strict";function e(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var i=function(){function t(t,e){this.values=t.slice(0),this.index_=e||0,this.loop_=!0}var e=t.prototype;return e.index=function(t){if(void 0===t)return this.index_;this.index_=Math.max(0,Math.min(t,this.values.length-1))},e.loop=function(t){if(void 0===t)return this.loop_;this.loop_=!!t},e.calc=function(t){var e=this.index_+t,i=this.values.length;return this.loop_?(i+e)%i:Math.max(0,Math.min(e,i-1))},e.step=function(t){return this.index_=this.calc(t),this.values[this.index_]},e.current=function(){return this.values[this.index_]},e.next=function(){return this.step(1)},e.prev=function(){return this.step(-1)},e.ended=function(){return this.index_===this.values.length-1},t}(),n=t.getComponent("SettingMenuItem"),o=function(t){function i(e,i){var n;return void 0===i&&(i={}),n=t.call(this,e,{name:"QualityItem",label:"Quality",icon:"vjs-icon-hd",entries:i.quality||[]})||this,n.entries.length||n.hide(),n.addClass("vjs-setting-quality"),n}return e(i,t),i.prototype.update=function(e){t.prototype.update.call(this,e),this.player_.quality.pick(e.value)},i}(n);t.registerComponent("QualityItem",o),t.hook("setup",function(t){t.findChild("SettingMenu")[0].component.addChild(new o(t))});var r=function(t){function i(e,i,n){var o;return void 0===n&&(n=0),o=t.call(this,i,n)||this,o.player=e,o.pick(n),o}return e(i,t),i.prototype.pick=function(t){void 0!==t&&this.index(t);var e=this.player,i=this.current(),n=e.ended()?0:e.currentTime();n&&e.one("loadedmetadata",function(){e.one("canplaythrough",function(){e.currentTime(n)}),e.play()}),e.src(i.sources),e.trigger("qualitychange",Object.assign(i,{index:this.index()}))},i}(i),u=function(t){var e=this.player_,i=e.findChild("QualityItem")[0].component;e.quality=new r(e,t),i.setEntries(t.map(function(t,e){return{label:t.label,value:e,defalut:t.default}})),i.show(),e.trigger("quality")};t.registerPlugin("setQuality",u),t.hook("setup",function(t){var e=t.options_.quality||[];e.length&&t.setQuality(e)})}(videojs);
