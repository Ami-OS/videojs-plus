!function(t){"use strict";function e(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var i=t.getComponent("SettingMenuItem"),n=function(t){function i(e,i){var n;return void 0===i&&(i={}),n=t.call(this,e,{name:"SubtitlesMenuItem",label:"Subtitles",icon:"vjs-icon-subtitles",entries:i.subtitles||[]})||this,n.entries.length||n.hide(),n.addClass("vjs-setting-subtitles"),n}return e(i,t),i.prototype.update=function(e){t.prototype.update.call(this,e),this.player_.subtitles().pick(e.value)},i}(i);t.registerComponent("SubtitlesMenuItem",n),videojs.hook("setup",function(t){t.findChild("SettingMenu")[0].component.addChild(new n(t))});var l=t.getPlugin("plugin"),r=function(t){function i(e,i){var n;n=t.call(this,e,i)||this,n.flag=null,n.track=null;var l;return e.textTracks().on("change",function(){var t=this;clearTimeout(l);var i,n=[],r=this.tracks_.filter(function(t){if("subtitles"===t.kind&&(n.push(t),"showing"===t.mode))return i=t.label||t.id,!0})[0];l=setTimeout(function(){t.flag!==i&&(t.flag=i,r=r||{},e.trigger("subtitlechange",{index:n.indexOf(r),label:r.label||""}))},10)}),n}e(i,t);var n=i.prototype;return n.load=function(t){var e=this;void 0===t&&(t=[]);var i=this.player;if(t&&t.length){this.remove(),t.forEach(function(t){e.flag&&(t.default=t.label===e.flag);var n=i.addRemoteTextTrack(t,!0);!e.flag&&t.default&&(e.flag=t.label,e.track=n.track,n.track.mode="showing")});var n=i.findChild("SubtitlesMenuItem")[0].component;n.setEntries(t.map(function(t,e){return{label:t.label,value:e,defalut:t.default}})),n.show(),i.trigger("subtitles",t)}},n.remove=function(){for(var t=this.player.textTracks().tracks_.slice(0),e=0;e<t.length;e++){var i=t[e];i&&"subtitles"===i.kind&&this.player.removeRemoteTextTrack(i)}},n.pick=function(t){var e=this.player.textTracks(),i=e[t];i&&(i.mode="showing",this.track.mode="disabled",this.track=i)},i}(l);t.hook("setup",function(t){t.ready(function(){t.subtitles().load(t.options_.subtitles)})}),t.registerPlugin("subtitles",r)}(videojs);
